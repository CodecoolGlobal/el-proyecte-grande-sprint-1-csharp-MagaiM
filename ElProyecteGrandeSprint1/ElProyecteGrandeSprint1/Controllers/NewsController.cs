using System.Diagnostics;
using ElProyecteGrandeSprint1.Models;
using ElProyecteGrandeSprint1.Models.Entities.ApiEntities;
using ElProyecteGrandeSprint1.Services;
using Microsoft.AspNetCore.Mvc;
using Newtonsoft.Json;

namespace ElProyecteGrandeSprint1.Controllers
{
    [ApiController]
    [Route("[controller]")]
    public class NewsController : ControllerBase
    {
        private readonly ApiService _apiService;
        private readonly ILogger<NewsController> _logger;

        //private readonly string apiToken = "1763716cc7950373caaf84e0980fd9da";
        private readonly string apiToken = "4a489f19e465971200db4a380416fc12";
        private readonly string language = "en";

        public NewsController(ILogger<NewsController> logger, ApiService apiService)
        {
            _logger = logger;
            _apiService = apiService;
        }

        [HttpGet]
        public string GetVideoGamesNews()
        {
            var request = new HttpRequestMessage
            {
                Method = HttpMethod.Get,
                RequestUri = new Uri("https://videogames-news2.p.rapidapi.com/videogames_news/recent"),
                Headers =
                {
                    { "X-RapidAPI-Host", "videogames-news2.p.rapidapi.com" },
                    //{ "X-RapidAPI-Key", "300b4f9442msh9fd4cb14cea575bp1fbf95jsn2e9fef2be340" },
                    { "X-RapidAPI-Key", "44c0067568mshcd96a9adc6db887p13ebcfjsnc1d0ab0bf882" },
                },
            };

            var deals = _apiService.GetDataFromApi<News>(request);
            //var deals = "[{\"Title\":\"Xbox Games Will Be Streamed On TVs Without A Console - But With A Catch\",\"Date\":\"2022-06-09T14:19:21Z\",\"Description\":\"Microsoft has revealed that Xbox Game Pass will be streamable on Samsung 2022 Smart TVs this month, without the need for extra hardware.\",\"Image\":\"https://static3.srcdn.com/wordpress/wp-content/uploads/2022/06/Xbox-Samsung-TV-Cover.jpg\",\"Link\":\"https://screenrant.com/xbox-game-pass-tv-streaming-no-console/\"},{\"Title\":\"PS5\\u0027s DualSense Firmware Appears On Steam Database\",\"Date\":\"2022-06-09T14:18:15Z\",\"Description\":\"This could mean the DualSense will soon be officially supported on Steam.\",\"Image\":\"https://static1.thegamerimages.com/wordpress/wp-content/uploads/2022/05/Astro-Boy-Hugs-DualSense-Controller.jpg\",\"Link\":\"https://www.thegamer.com/ps5-dualsense-firmware-steam-database/\"},{\"Title\":\"Call of Duty: Warzone 2 release date rumours: upgrades and crossplay\",\"Date\":\"2022-06-09T16:10:41+02:00\",\"Description\":\"Want to know more about Call of Duty: Warzone 2 release date? In a special briefing earlier this year, Infinity Ward confirmed their hugely successful Call of Duty battle royale game is getting a sequel. Warzone 2 looks set to be built on a new engine, with an all-new playspace and a sandbox mode, resulting in a \\u201Cmassive evolution of Battle Royale\\u201D. With Call of Duty Warzone Season 3 Reloaded in full swing and Activision Blizzard confirming the game reached over 100 million active players last year, Warzone 2 is undoubtedly one of the biggest upcoming games in some time. We finally know a lot more about Warzone 2 thanks to the recent reveal of Modern Warfare 2\\u0027s release date, including the host of engine upgrades coming to the FPS game. Sadly, we still don\\u0027t know when the Warzone 2 release date is. We\\u2019ve put together this guide with everything we know about Warzone 2, including its rumoured release date, what the next Warzone map might look like, and much more.\",\"Image\":\"https://www.pcgamesn.com/wp-content/uploads/2022/05/call-of-duty-warzone-2-release-date-goggles.jpg\",\"Link\":\"https://www.pcgamesn.com/call-of-duty-warzone-2/release-date\"},{\"Title\":\"Microsoft Details Activision Blizzard Acquisition, Exclusives, and Game Pass\",\"Date\":\"2022-06-09T14:07:46Z\",\"Description\":\"Microsoft executive Matt Booty discusses the Activision Blizzard acquisition and how it plans to handle exclusive titles and Xbox Game Pass.\",\"Image\":\"https://static0.gamerantimages.com/wordpress/wp-content/uploads/2022/06/microsoft-activision-game-pass.jpg\",\"Link\":\"https://gamerant.com/microsoft-activision-blizzard-acquisition-exclusives-game-pass/\"},{\"Title\":\"7 Games That Got Ray Tracing Post Launch\",\"Date\":\"2022-06-09T14:05:13Z\",\"Description\":\"These games saw the light after they were released.\",\"Image\":\"https://static1.thegamerimages.com/wordpress/wp-content/uploads/2022/06/Ray-tracing-update-post-launch-featured.jpg\",\"Link\":\"https://www.thegamer.com/video-games-ray-tracing-post-launch/\"},{\"Title\":\"Starfield could launch on Xbox Game Pass in early 2023\",\"Date\":\"2022-06-09T16:02:14+02:00\",\"Description\":\"Starfield is expected to release at some point in 2023, but a subtle Xbox Game Pass disclaimer suggests the sci-fi romp could arrive within the first few months. The rumour should bring comfort to Bethesda fans waiting for the publisher\\u0027s next best RPG game, but there\\u0027s room for debate over the exact meaning of the potentially unintentional blurb. Highlighted by Reddit user Ganndalf, the spotted disclaimer states that Starfield is \\u0022expected early 2023.\\u0022 This means the space adventure may show up as early as January, but it also hints at a Q1 release date window. Of course, the Xbox Game Pass information might also be a reference to Bethesda\\u0027s previous Starfield delay, which claimed the game\\u0027s launch was pushed back to \\u0022the first half\\u0022 of next year. Just like with all rumours and speculation, you should take this Starfield release date tidbit with a grain of salt. That said, it perhaps helps reassure those eagerly awaiting the RPG\\u0027s arrival, as some Starfield fans have resorted to staring at doors to uncover any news.\",\"Image\":\"https://www.pcgamesn.com/wp-content/uploads/2022/06/starfield-xbox-game-pass-early-2023-rumour.jpg\",\"Link\":\"https://www.pcgamesn.com/starfield/xbox-game-pass-early-2023-rumour\"},{\"Title\":\"The Decade-Long Struggle To Fund Oakland\\u2019s Scrappy Video Game Museum\",\"Date\":\"2022-06-09T14:00:00Z\",\"Description\":\"Back in September 2021, The Museum of Art and Digital Entertainment in Oakland, California, better known as The MADE, began tweeting about how impossibly difficult it seemed to fund a video game museum. Read more...\",\"Image\":\"https://i.kinja-img.com/gawker-media/image/upload/s--vnlgvTpg--/c_fit,fl_progressive,q_80,w_636/ec8fea1df2cde7293433b4081bff74fb.jpg\",\"Link\":\"https://kotaku.com/the-made-oakland-game-museum-funding-dolby-ea-ubisoft-g-1849030490\"},{\"Title\":\"The Quarry system requirements\",\"Date\":\"2022-06-09T15:57:04+02:00\",\"Description\":\"The masterminds behind Until Dawn are back with another horror game, but before you can enjoy the thrill of the chase, you\\u0027ll first need to check whether your gaming PC meets The Quarry system requirements. You have a good chance of being able to run the frightfest if your rig can play any of The Dark Pictures Anthology series, but the recommended specs are reserved for modern systems built within the past couple of years. It\\u0027s not clear what kind of resolutions or frame rates Supermassive Games aims for with The Quarry system requirements, but hitting the minimum is relatively easy. Much like other games in the developer\\u0027s catalogue, you\\u0027ll be able to boot with a decade-old gaming CPU, a six-year-old graphics card, the standard 8GB of RAM, and 50GB of space. It doesn\\u0027t even require the speed of the best SSD for gaming, although it couldn\\u0027t hurt if you wanted to pick up the pace of loading times. To hit the recommended system requirements, The Quarry doesn\\u0027t just demand processors released in 2020 onwards, but top-of-the-line chips at that. It lists the Intel Core i9 10900K and AMD Ryzen 7 3800 XT,  setting a high bar for those that haven\\u0027t upgraded in a while. Recommended GPU requirements aren\\u0027t quite as extreme considering it targets entry-to-mid range and new Nvidia RTX 4000 graphics cards are just around the corner, but some may find these specs somewhat punishing.\",\"Image\":\"https://www.pcgamesn.com/wp-content/uploads/2022/05/The-Quarry-system-requirements.jpg\",\"Link\":\"https://www.pcgamesn.com/the-quarry/system-requirements\"},{\"Title\":\"Watch Summer Game Fest Live: Official Stream Links | Screen Rant\",\"Date\":\"2022-06-09T13:54:14Z\",\"Description\":\"Summer Game Fest 2022 is ready to fill the void that E3 left once again, and here are all the official streams - including YouTube, Twitch, and Steam!\",\"Image\":\"https://static0.srcdn.com/wordpress/wp-content/uploads/2022/06/Summer-Game-Fest-Watch-Online.jpg\",\"Link\":\"https://screenrant.com/summer-game-fest-2022-watch-official-stream-links/\"},{\"Title\":\"Some Future Activision Blizzard Games Will Be Xbox-Exclusive, Microsoft Confirms\",\"Date\":\"2022-06-09T15:44:00+02:00\",\"Description\":\"Microsoft has revealed more details on its plans for Activision Blizzard, once its planned acquisition of the gaming company has been completed. During a media briefing, Xbox Game Studios head Matt Booty spoke about exclusivity and how Microsoft wants to ensure that the communities for some of Activision Blizzard\\u0027s biggest multiplatform properties are looked after.\",\"Image\":\"https://www.gamespot.com/a/uploads/screen_medium/1601/16018044/3987987-xboxactiblizz.jpg\",\"Link\":\"https://www.gamespot.com/articles/some-future-activision-blizzard-games-will-be-xbox-exclusive-microsoft-confirms/1100-6504322/?ftag=CAD-01-10abi2f\"}]";
            return deals;
        }
        
        [HttpGet("{game}")]
        public string GetGNews(string game)
        {
            var request = new HttpRequestMessage
            {
                Method = HttpMethod.Get,
                RequestUri = new Uri($"https://gnews.io/api/v4/search?q={game}&token={apiToken}&lang={language}"),
            };

            var deals = _apiService.GetDataFromApi<GNewsResponse>(request);
            //var deals = "[{\"Title\":\"Arlington plays host to Overwatch League major tournament\",\"Description\":\"There was a lot of hype and energy as the line of esports fans wrapped around the walkway waiting to get in the Esports Stadium Arlington for the first Overwatch League major tournament of 2022.\",\"Content\":\"There was a lot of hype and energy as the line of esports fans wrapped around the walkway waiting to get in the Esports Stadium Arlington for the first Overwatch League major tournament of 2022.\\n\\u0022I\\u2019m really excited. My team\\u2019s here, so I get to see th... [904 chars]\",\"Link\":\"https://www.fox4news.com/news/arlington-overwatch-league-major-tournament\",\"Image\":\"https://images.foxtv.com/static.fox4news.com/www.fox4news.com/content/uploads/2022/06/1280/720/060222-ARLINGTON-ESPORTS-PKG-ANGLIN_00.00.42.15.png?ve=1\\u0026tl=1\",\"Date\":\"2022-06-02T23:53:05Z\",\"Source\":{\"Name\":\"FOX 4 News\",\"Url\":\"https://www.fox4news.com\"}},{\"Title\":\"Paris\\u2019 Overwatch and Call of Duty teams are moving to Las Vegas\",\"Description\":\"The Overwatch League team Paris Eternal and its sister Call of Duty League team, Paris Legion, will relocate to Las Vegas in 2023.\",\"Content\":\"The Overwatch League has its first official team relocation. The Paris Eternal, one of the League\\u2019s two European teams, will move to Las Vegas for the 2023 season.\\nRumors of a potential relocation started after an eagle-eyed fan noticed that DM-Espor... [2314 chars]\",\"Link\":\"https://www.theverge.com/2022/6/2/23151691/overwatch-league-paris-eternal-relocation-las-vegas\",\"Image\":\"https://cdn.vox-cdn.com/thumbor/E4D7XeNxem6Vm8bMdhoq0P9x_kY=/0x86:1200x714/fit-in/1200x630/cdn.vox-cdn.com/uploads/chorus_asset/file/23603742/OWL_Press_Asset_BZ66H0.jpg\",\"Date\":\"2022-06-02T16:43:43Z\",\"Source\":{\"Name\":\"The Verge\",\"Url\":\"https://www.theverge.com\"}},{\"Title\":\"Paris Legion, Paris Eternal to relocate to Las Vegas in 2023\",\"Description\":\"The Call of Duty League and Overwatch League franchises are set to leave the French capital for a Sin City swap ahead of the 2023 season.\",\"Content\":\"The French capital is losing two of its premier esports teams.\\nCall of Duty League and Overwatch League franchises Paris Legion and Paris Eternal will relocate to Las Vegas ahead of their respective 2023 seasons, the ownership company behind both tea... [2913 chars]\",\"Link\":\"https://dotesports.com/news/paris-legion-paris-eternal-to-relocate-to-las-vegas-in-2023\",\"Image\":\"https://cdn1.dotesports.com/wp-content/uploads/2022/06/01190755/o1554786249671216-768x512.jpeg\",\"Date\":\"2022-06-02T00:09:48Z\",\"Source\":{\"Name\":\"Dot Esports\",\"Url\":\"https://dotesports.com\"}},{\"Title\":\"Loot box laws reportedly keep Diablo Immortal out of 2 countries\",\"Description\":\"Regulators in Belgium and the Netherlands have previously ruled against Blizzard\\u2019s loot boxes in other games, like Overwatch. Blizzard Entertainment reportedly won\\u2019t release the upcoming Diablo Immortal in those countries.\",\"Content\":\"Diablo Immortal, Blizzard Entertainment\\u2019s free-to-play Diablo game, is set to launch on Windows PC and mobile Wednesday. But it\\u2019ll reportedly stay offline in two European countries: Belgium and the Netherlands.\\nThat\\u2019s because of those countries\\u2019 stri... [1653 chars]\",\"Link\":\"https://www.polygon.com/23149045/diablo-immortal-netherlands-belgium-loot-boxes\",\"Image\":\"https://cdn.vox-cdn.com/thumbor/j0SGLDffzHAjX0B157yabzoMoSY=/0x8:3480x1830/fit-in/1200x630/cdn.vox-cdn.com/uploads/chorus_asset/file/13381973/Diablo_Bone.jpg\",\"Date\":\"2022-05-31T21:49:14Z\",\"Source\":{\"Name\":\"Polygon\",\"Url\":\"https://www.polygon.com\"}},{\"Title\":\"Overwatch League may be attempting to use free artwork, labor again\",\"Description\":\"Overwatch: This time, Blizzard is having freelancers sign a document that states they can use photos and videos as they please.\",\"Content\":\"Source: Activision Blizzard\\nThe Overwatch League may be attempting to get free labor once again.\\nBack in March, the Overwatch community grew frustrated with the Overwatch League over the conditions of an art contest. It seemed innocent enough at firs... [2422 chars]\",\"Link\":\"https://www.invenglobal.com/articles/17342/overwatch-league-may-be-attempting-to-use-free-artwork-labor-again\",\"Image\":\"https://static.invenglobal.com/upload/image/2022/05/31/r1654031057081986.jpeg\",\"Date\":\"2022-05-31T21:06:20Z\",\"Source\":{\"Name\":\"InvenGlobal\",\"Url\":\"https://www.invenglobal.com\"}},{\"Title\":\"Overwatch 2\\u2019s beta ending has left players with a demoralizing hangover\",\"Description\":\"Overwatch 2\\u0027s beta ending has left the franchise in a strange purgatory, leaving players, both casual and professional in an awkward spot.\",\"Content\":\"Overwatch 2\\u2019s first beta period was always planned to end. But that doesn\\u2019t make it any easier to accept.\\nA new presentation (opens in new tab) unveiling what\\u2019s coming to Overwatch 2 in the next beta has been set for June 16. The hope is that we\\u2019ll g... [5159 chars]\",\"Link\":\"https://www.techradar.com/opinion/overwatch-2s-beta-ending-has-left-players-in-a-demoralizing-hangover\",\"Image\":\"https://cdn.mos.cms.futurecdn.net/cvVtvWkFyrMzwAEPX6gkwi-1200-80.jpg\",\"Date\":\"2022-05-28T12:00:00Z\",\"Source\":{\"Name\":\"TechRadar\",\"Url\":\"https://www.techradar.com\"}},{\"Title\":\"Despite a new hero, Ana proved to be most popular in Overwatch 2 beta\",\"Description\":\"Blizzard released some metrics behind the Overwatch 2 beta that included the\\nhero usage, with fairly surprising results.\",\"Content\":\"Blizzard released some metrics behind the Overwatch 2 beta that included the hero usage, with fairly surprising results.\\nSojourn was eagerly awaited as she would be the hero that would finally end the content draught in Overwatch so when she ended up... [1130 chars]\",\"Link\":\"https://www.altchar.com/game-news/despite-a-new-hero-ana-proved-to-be-most-popular-in-overwatch-2-beta-aiNwF3w9oQ0W\",\"Image\":\"https://media.altchar.com/prod/images/940_530/gm-4077da2e-1959-425d-8e61-69c7951fed92-anascreenshot004.jpeg\",\"Date\":\"2022-05-26T07:03:00Z\",\"Source\":{\"Name\":\"AltChar\",\"Url\":\"https://www.altchar.com\"}},{\"Title\":\"Blizzard Reveals The Most-Played Characters In The Overwatch 2 Beta\",\"Description\":\"Here\\u0027s how much each character--including Overwatch 2\\u0027s new entry, Sojourn--was used in the beta.\",\"Content\":\"Overwatch 2\\u0027s first PvP beta just wrapped up on May 17, leaving the development team with a lot of data to sift through before the next beta begins. Now, Blizzard has shared some of that data in a blog post, revealing some interesting stats on hero u... [1762 chars]\",\"Link\":\"https://www.gamespot.com/articles/blizzard-reveals-the-most-played-characters-in-the-overwatch-2-beta/1100-6503817/\",\"Image\":\"https://www.gamespot.com/a/uploads/screen_kubrick/1597/15975876/3981567-3965050-ovr_sojourn_002.jpg\",\"Date\":\"2022-05-25T08:10:33Z\",\"Source\":{\"Name\":\"GameSpot\",\"Url\":\"https://www.gamespot.com\"}},{\"Title\":\"Luminosity, Vancouver Titans parent company CEO under fire for creating \\u0022divisive culture\\u0022 at esports org\",\"Description\":\"Overwatch: Investors call for Enthusiast Gaming CEO to be replaced.\",\"Content\":\"\\u25B2 Image via Enthusiast Gaming\\nEnthusiast Gaming\\u0027s largest shareholder is calling for the removal of the company\\u0027s CEO and board of directors.\\nEnthusiast Gaming owns Luminosity, Vancouver Titans, and the Seattle Surge. The esports org has come under f... [3345 chars]\",\"Link\":\"https://www.invenglobal.com/articles/17283/luminosity-vancouver-titans-parent-company-ceo-under-fire-for-creating-divisive-culture-at-esports-org\",\"Image\":\"https://static.invenglobal.com/upload/image/2022/05/24/o1653411306262762.jpeg\",\"Date\":\"2022-05-24T16:56:52Z\",\"Source\":{\"Name\":\"InvenGlobal\",\"Url\":\"https://www.invenglobal.com\"}},{\"Title\":\"NYC Mayor Says Overwatch\\u0027s Hanzo Is Garbage\",\"Description\":\"Wish this were clickbait, but it\\u0027s not.\",\"Content\":\"It\\u0027s rare to see a politician express opinions on video games, or at least somewhat informed opinions. NYC Mayor Eric Adams decided to break precedent and throw in his two cents about one Overwatch character in particular--Hanzo.\\nI couldn\\u0027t mash the ... [1542 chars]\",\"Link\":\"https://www.gamespot.com/articles/nyc-mayor-says-overwatchs-hanzo-is-garbage/1100-6503655/\",\"Image\":\"https://www.gamespot.com/a/uploads/screen_kubrick/1597/15971658/3979363-hanzo_thumb.jpg\",\"Date\":\"2022-05-19T19:40:25Z\",\"Source\":{\"Name\":\"GameSpot\",\"Url\":\"https://www.gamespot.com\"}}]";
            return deals;
        }
    }
}
